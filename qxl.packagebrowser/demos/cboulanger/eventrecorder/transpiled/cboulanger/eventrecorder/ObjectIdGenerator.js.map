{
  "version": 3,
  "sources": [
    "/home/runner/work/qxl.packagebrowser/qxl.packagebrowser/packages/qx_packages/cboulanger_eventrecorder_v0_18_0/source/class/cboulanger/eventrecorder/ObjectIdGenerator.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "extend",
    "core",
    "Object",
    "include",
    "cboulanger",
    "eventrecorder",
    "MHelperMethods",
    "events",
    "members",
    "init",
    "event",
    "Timer",
    "once",
    "assignObjectIdsToChildren",
    "Init",
    "getApplication",
    "getRoot",
    "fireEvent",
    "addGlobalEventListener",
    "target",
    "getType",
    "generateId",
    "qxObj",
    "clazz",
    "classname",
    "substr",
    "lastIndexOf",
    "generateQxObjectId",
    "obj",
    "owner",
    "id",
    "getQxObjectId",
    "setQxObjectId",
    "siblingWithSameName",
    "postfix",
    "addOwnedQxObject",
    "e",
    "Id",
    "getInstance",
    "register",
    "parent",
    "level",
    "children",
    "getChildren",
    "getLayoutChildren",
    "length",
    "child",
    "ui",
    "popup",
    "Popup",
    "realChild",
    "getChildControl",
    "getSelection",
    "getMenu",
    "addListener",
    "getSelectionModel",
    "_manager",
    "defer",
    "bom",
    "Lifecycle",
    "onReady",
    "ObjectIdGenerator"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * When added to the `applications[x].include` section of `compile.json`,\n * this class will automatically assign ids to all the widgets in the\n * widget hierarchy, i.e. all objects that are added as child object via\n * the `add()` method provided my `qx.ui.core.MChildrenHandling`. The id\n * generator assigns ids to all widgets that do not already have an id\n * using the last part of the class namespace plus the integer hash code of\n * the widget. This will result in absolute ids of the form\n * `Composite50/Scroll117/TabView120/TabPage147`\n */\nqx.Class.define(\"cboulanger.eventrecorder.ObjectIdGenerator\", {\n  type: \"singleton\",\n  extend: qx.core.Object,\n  include : [cboulanger.eventrecorder.MHelperMethods],\n  events: {\n    \"done\" : \"qx.event.type.Event\"\n  },\n  members: {\n\n    /**\n     * Start automatically assigning ids.\n     */\n    init: function() {\n      // start generating ids with a delay because rendering widgets is asynchrous\n      qx.event.Timer.once(() => {\n        this.assignObjectIdsToChildren(qx.core.Init.getApplication().getRoot());\n        this.fireEvent(\"done\");\n      }, null, 2000);\n      this.addGlobalEventListener((target, event) => {\n        if (event.getType() === \"appear\") {\n          this.assignObjectIdsToChildren(qx.core.Init.getApplication().getRoot());\n        }\n      });\n    },\n\n    /**\n     * Given a {@link qx.core.Object}, return an id for it, which is the last\n     * part of the class name\n     * @param qxObj {qx.core.Object}\n     * @return {String}\n     */\n    generateId: function(qxObj) {\n      let clazz = qxObj.classname;\n      return clazz.substr(clazz.lastIndexOf(\".\")+1);\n    },\n\n    /**\n     * Given an object and its parent, set its object id and add it to the\n     * parent's owned objects. If the object doesn't have a parent or the\n     * parent has no object id, register the object as a global id root.\n     * @param obj The object to assign an object id to\n     * @param owner The owning parent object\n     * @param id {String|undefined} Optional id. If not given, generate an id from\n     * the class name\n     */\n    generateQxObjectId: function(obj, owner, id) {\n      if (!obj || typeof obj.getQxObjectId != \"function\" || obj.getQxObjectId()) {\n        return;\n      }\n      id = id || this.generateId(obj);\n      obj.setQxObjectId(id);\n      if (owner && owner.getQxObjectId()) {\n        // if the parent has an id, we add the child as an owned object\n        let siblingWithSameName = false;\n        let postfix = 1;\n        do {\n          try {\n            owner.addOwnedQxObject(obj);\n            siblingWithSameName=false;\n            // console.log(`Adding ${obj} to ${parent} with id '${id}'`);\n          } catch (e) {\n            // name already exists, append a number\n            siblingWithSameName = true;\n            postfix++;\n            obj.setQxObjectId(id+postfix);\n          }\n        } while (siblingWithSameName);\n      } else {\n        // otherwise, we register it as a top-level object\n        //console.log(`Registering ${obj} as global id root with id '${id}'`);\n        qx.core.Id.getInstance().register(obj, id);\n      }\n    },\n\n    /**\n     * Recursively assigns object ids to the children of the given parent widget.\n     * @param parent {qx.ui.core.Widget|qx.ui.core.MChildrenHandling} An object that must include\n     * the qx.ui.core.MChildrenHandling mixin.\n     * @param level {Number}\n     */\n    assignObjectIdsToChildren: function(parent, level=0) {\n      if (!parent) {\n        return;\n      }\n      let children =\n        typeof parent.getChildren == \"function\" ?\n          parent.getChildren() :\n          typeof parent.getLayoutChildren == \"function\" ?\n            parent.getLayoutChildren() : null;\n      // let msg = \"    \".repeat(level) + parent.classname;\n      // if ( !children || ! children.length) {\n      //   console.log(msg + \" (no children)\");\n      //   return;\n      // }\n      // console.log(msg);\n      if (!children || !children.length) {\n        return;\n      }\n      for (let child of children) {\n       // ignore popups\n       if (child instanceof qx.ui.popup.Popup) {\n         continue;\n       }\n        // assign object id and add to parent if neccessary\n        this.generateQxObjectId(child, parent);\n        // recurse into children\n        let realChild = child;\n        let id;\n        switch (child.classname) {\n          case \"qx.ui.form.ComboBox\":\n            realChild = child.getChildControl(\"textfield\");\n            break;\n          case \"qx.ui.form.VirtualSelectBox\":\n            realChild = child.getSelection();\n            break;\n          case \"qx.ui.groupbox.GroupBox\":\n            realChild = child.getChildControl(\"frame\");\n            break;\n          case \"qx.ui.form.MenuButton\":\n          case \"qx.ui.toolbar.MenuButton\":\n          case \"qx.ui.menubar.Button\":\n            realChild = child.getMenu();\n            break;\n          case \"qx.ui.treevirtual.TreeVirtual\":\n            child.addListener(\"treeClose\", () => {});\n            child.addListener(\"treeOpenWithContent\", () => {});\n            child.addListener(\"treeOpenWhileEmpty\", () => {});\n            // fallthrough\n          case \"qx.ui.table.Table\":\n            realChild = child.getSelectionModel();\n            id = \"Selection\";\n            break;\n          case \"qx.ui.list.List\":\n            realChild = child.getSelection();\n            id = \"Selection\";\n            break;\n          case \"qx.ui.tabview.Page\":\n            this.generateQxObjectId(child.getChildControl(\"button\"), child);\n            break;\n          case \"qx.ui.tree.VirtualTree\":\n            child.addListener(\"open\", () => {});\n            child.addListener(\"close\", () => {});\n            this.generateQxObjectId(child._manager, child);\n            continue;\n        }\n        if (realChild !== child) {\n          this.generateQxObjectId(realChild, child, id);\n        }\n        this.assignObjectIdsToChildren(realChild, level+1);\n      }\n    }\n  },\n\n  /**\n   * Will be called after class has been loaded, before application startup\n   */\n  defer: function() {\n    if (qx.core.Environment.get(\"module.objectid\")) {\n      qx.bom.Lifecycle.onReady(() => cboulanger.eventrecorder.ObjectIdGenerator.getInstance().init());\n    }\n  }\n});\n"
  ]
}